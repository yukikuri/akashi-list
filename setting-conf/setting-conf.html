<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>設定import・export</title><style>body{margin:0}h4{margin-block-start:0}.section input[type=file]{display:block;margin-bottom:10px}.setting-conf-root button{padding:10px 20px;background-color:#1e8eff;color:#fff;border:none;border-radius:4px;width:170px}.menu-section{margin-bottom:2em}.setting-input-content{width:100%;max-width:500px;display:flex;justify-content:center;align-items:center;height:4em}.setting-input-content.import{height:14em;border:1px dashed #999}.import p{text-align:center}.upload-icon svg{width:50px;height:50px}.upload-icon{margin-top:1em}#setting-file-dropzone.over{background-color:#f0f6ff}.setting-file-input{display:none}.confirm-fullscreen{display:none}.file-info-content{display:none;color:red;line-height:1.5em}.file-info-content.show{display:block}.file-info-content .icon{display:inline-block;width:1.5em;height:1.5em;vertical-align:top}.file-info-content .icon svg{fill:red}</style></head><body class=setting-conf-root><template id=weapon-image-template><span class=wimage><img></span></template><template id=toast-content-template><div>インポートに成功しました。</div></template><template id=confirm-fullscreen-template><div class=confirm-content><div class=content-root><div class=header><span class=title>インポートの確認</span></div><div class=content><p>次の設定をインポートしますか？インポートでは現在の設定を上書きします。</p><p><div class=buttons><button class=doImport>設定をインポート</button>
<button class=importCancel>キャンセル</button></div></p><div class=setting-content-container><div class=content-title>現在の設定 クリップ数：<span class="weapon-count current">-</span></div><div></div><div class=content-title>インポートする設定 クリップ数：<span class="weapon-count import">-</span></div><div class="weapons current"></div><div></div><div class="weapons import"></div></div></div><div class=footer></div></div></div><div class=margin-bottom></div></template><div class=setting-conf data-name=setting-conf><div><div class=menu-section><h4>クリップ設定のダウンロード</h4><p>現在のクリップ設定をファイルに保存します。保存した設定ファイルは「設定のインポート」で使用できます。</p><div class="setting-input-content download"><button>設定のダウンロード</button></div></div><div class=menu-section><h4>クリップ設定のインポート</h4><p>保存した設定ファイルを選択してインポートします。インポートすることで以前保存した設定を復元することができます。</p><div class="setting-input-content import" id=setting-file-dropzone><div><p class=upload-icon><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24" fill="#5f6368"><path d="M450-224.62h60V-402l74 74 42.15-42.77L480-516.92 333.85-370.77l42.77 42.15L450-402v177.38zM252.31-1e2Q222-1e2 201-121t-21-51.31v-615.38Q180-818 201-839t51.31-21H570l210 210v477.69Q780-142 759-121t-51.31 21H252.31zM540-620v-180H252.31q-4.62.0-8.46 3.85-3.85 3.84-3.85 8.46v615.38q0 4.62 3.85 8.46 3.84 3.85 8.46 3.85h455.38q4.62.0 8.46-3.85 3.85-3.84 3.85-8.46V-620H540zM240-8e2v180-180 640-640z"/></svg></p><p>インポートするファイルをここにドラッグ＆ドロップ</p><p>もしくは</p><p><input type=file id=settingFileInput class=setting-file-input accept=.json>
<button>ファイルを参照...</button></p></div></div><p class=file-info-content><span class=icon><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M11 17h2v-6h-2v6zm1-15C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41.0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM11 9h2V7h-2v2z"/></svg></span><span class=msg></span></p></div></div></div><script>var cdn="https://aiacdn.webstg.space/",isValidWeaponId,buildWeaponImg,buildDateStr,downloadSettings,downloadBtn,selectImportSettingFile,importBtn,buildWeaponContent,insertWeaponsContent,updateWeaponCount,filterProperties,getForFilterSetting,showClipWeapon,showToast,weaponIds=["w001","w002","w003","w004","w005","w006","w007","w008","w009","w010","w011","w012","w013","w014","w015","w016","w017","w018","w019","w020","w021","w022","w023","w024","w025","w026","w027","w028","w029","w030","w031","w032","w033","w034","w035","w036","w037","w038","w039","w040","w041","w042","w043","w044","w045","w046","w047","w048","w049","w050","w051","w052","w053","w054","w055","w056","w057","w058","w059","w060","w061","w062","w063","w064","w065","w066","w067","w068","w069","w070","w071","w072","w073","w074","w075","w076","w077","w078","w079","w080","w081","w082","w083","w084","w085","w086","w087","w088","w089","w090","w091","w092","w093","w094","w095","w096","w097","w098","w099","w100","w101","w102","w103","w104","w105","w106","w107","w108","w109","w110","w111","w112","w113","w114","w115","w116","w117","w118","w119","w120","w121","w122","w123","w124","w125","w126","w127","w128","w129","w130","w131","w132","w133","w134","w135","w136","w137","w138","w139","w140","w141","w142","w143","w144","w145","w146","w147","w148","w149","w150","w151","w152","w153","w154","w155","w156","w157","w158","w159","w160","w161","w162","w163","w164","w165","w166","w167","w168","w169","w170","w171","w172","w173","w174","w175","w176","w177","w178","w179","w180","w181","w182","w183","w184","w185","w186","w187","w188","w189","w190","w191","w192","w193","w194","w195","w196","w197","w198","w199","w200","w201","w202","w203","w204","w205","w206","w207","w208","w209","w210","w211","w212","w213","w214","w215","w216","w217","w218","w219","w220","w221","w222","w223","w224","w225","w226","w227","w228","w229","w230","w231","w232","w233","w234","w235","w236","w237","w238","w239","w240","w241","w242","w243","w244","w245","w246","w247","w248","w249","w250","w251","w252","w253","w254","w255","w256","w257","w258","w259","w260","w261","w262","w263","w264","w266","w267","w268","w269","w270","w271","w272","w273","w274","w275","w276","w277","w278","w279","w280","w281","w282","w283","w284","w285","w286","w287","w288","w289","w290","w291","w292","w293","w294","w295","w296","w297","w298","w299","w300","w301","w302","w303","w304","w305","w306","w307","w308","w309","w310","w311","w312","w313","w314","w315","w316","w317","w318","w319","w320","w322","w323","w324","w325","w326","w327","w328","w329","w330","w331","w332","w333","w334","w335","w336","w338","w339","w340","w341","w342","w343","w344","w345","w346","w347","w348","w349","w350","w351","w352","w353","w354","w355","w356","w357","w358","w359","w360","w361","w362","w363","w364","w365","w366","w367","w368","w369","w370","w371","w372","w373","w374","w375","w376","w377","w378","w379","w380","w381","w382","w383","w384","w385","w386","w387","w388","w389","w390","w391","w392","w393","w394","w395","w396","w397","w398","w399","w400","w401","w402","w403","w404","w405","w406","w407","w408","w409","w410","w411","w412","w413","w414","w415","w416","w417","w418","w419","w420","w421","w422","w423","w424","w425","w426","w427","w428","w429","w430","w431","w432","w433","w434","w435","w436","w437","w438","w439","w440","w441","w442","w443","w444","w445","w446","w447","w449","w450","w451","w452","w453","w454","w455","w456","w457","w458","w459","w460","w461","w463","w464","w465","w466","w467","w468","w469","w470","w471","w472","w473","w474","w475","w476","w477","w478","w479","w480","w481","w482","w483","w484","w485","w486","w487","w488","w489","w490","w491","w492","w493","w494","w495","w496","w497","w498","w499","w500","w501","w502","w503","w504","w505","w506","w507","w508","w509","w510","w511","w512","w513","w514","w515","w516","w517","w518","w519","w520","w521","w522","w523","w524","w525","w526","w527","w528","w529","w530","w531","w532","w533","w534","w535","w536","w537","w538","w541","w542","w543","w544"];"use strict";class SettingDropArea{constructor(){var e,t=document.getElementById("settingFileInput");t&&(t.addEventListener("click",e=>this.handleFileInputClick(e)),t.addEventListener("change",e=>this.handleFileInputChange(e))),e=document.getElementById("setting-file-dropzone"),this.dropzone=e,e&&(e.addEventListener("dragenter",e=>this.handleDragEnter(e)),e.addEventListener("dragover",e=>this.handleDragOver(e)),e.addEventListener("dragleave",e=>this.handleDragLeave(e)),e.addEventListener("drop",e=>this.handleDrop(e)))}setSelectFileNgInfo(e){var n,s,t=document.querySelector(".file-info-content");if(!t)return;n=t.querySelector(".msg"),n&&(n.textContent=e??""),s="show",e?t.classList.add(s):t.classList.remove(s)}handleDragEnter(){this.setSelectFileNgInfo("")}handleDragOver(e){e.preventDefault();var t=this.dropzone;t.classList.contains("over")||t.classList.add("over")}handleDragLeave(e){var t=this.dropzone,n=document.elementFromPoint(e.clientX,e.clientY);(!n||!t.contains(n))&&t.classList.remove("over")}handleDrop(e){e.preventDefault();var t=this.dropzone;t.classList.remove("over"),e.dataTransfer&&this.handleImportSettingFile(e.dataTransfer.files)}handleFileInputClick(){this.setSelectFileNgInfo("")}handleFileInputChange(e){var t=e.target;t&&t.files&&(this.handleImportSettingFile(t.files),t.value="")}handleImportSettingFile(e){var t,n=this.checkFileList(e);if(!n.isOk){this.setSelectFileNgInfo(n.reason);return}t=new FileReader,t.addEventListener("load",e=>{var s,o,n=void 0;try{t.result?(s=JSON.parse(window.localStorage.setting),o=JSON.parse(t.result),this.setSelectFileNgInfo(""),showClipWeapon(s,o)):n=new Error("empty content")}catch(e){this.setSelectFileNgInfo("インポートファイルの解析に失敗しました。インポートするファイル内容が正しくない可能性があります。"),n=e}n}),t.readAsText(e[0])}checkFileList(e){var n,t=e=>({isOk:!1,reason:e});return e.length!=1?t("1つのファイルのみインポート可能です。複数のファイルが選択されましたので、単一のファイルとしてください。"):(n=e[0],n.size>=50*1024?t("インポートするファイルサイズが想定より大きすぎます。"):{isOk:!0})}}new SettingDropArea,isValidWeaponId=e=>{var t="w"+e;return!!weaponIds.find(e=>e===t)},buildWeaponImg=e=>"".concat(cdn,"img/weapon").concat(e,".png"),buildDateStr=()=>{var e=new Date,t=e.getFullYear(),n=("0"+(e.getMonth()+1)).slice(-2),s=("0"+e.getDate()).slice(-2);return""+t+n+s},downloadSettings=()=>{var n=JSON.parse(window.localStorage.setting),s=JSON.stringify(n,null,2),o=new Blob([s],{type:"application/json"}),t=URL.createObjectURL(o),i=buildDateStr(),e=document.createElement("a");e.style.display="none",e.href=t,e.download="akashi-list-setting-"+i+".json",document.body.appendChild(e),e.click(),URL.revokeObjectURL(t),document.body.removeChild(e)},downloadBtn=document.querySelector(".setting-input-content.download button"),downloadBtn&&downloadBtn.addEventListener("click",downloadSettings),selectImportSettingFile=()=>{var e=document.getElementById("settingFileInput");e&&e.click()},importBtn=document.querySelector(".setting-input-content.import button"),importBtn&&importBtn.addEventListener("click",selectImportSettingFile),buildWeaponContent=e=>{if(!isValidWeaponId(e))return;var t,n,s=document.getElementById("weapon-image-template");if(!s)return;if(t=s.content.cloneNode(!0),n=t.querySelector(".wimage img"),!n)return;return n.setAttribute("src",buildWeaponImg(e)),t},insertWeaponsContent=(e,t,n)=>{var s,o=e.querySelector(".weapons"+n);if(!o)return;s=t.concat(),s.sort(),o.innerHTML="",s.forEach(e=>{var t=buildWeaponContent(e);t&&o.appendChild(t)}),updateWeaponCount(e,s.length,n)},updateWeaponCount=(e,t,n)=>{var s=e.querySelector(".weapon-count"+n);s&&(s.textContent=t.toString())},filterProperties=(e,t)=>Object.keys(t).reduce((t,n)=>(n in e&&(t[n]=e[n]),t),{}),getForFilterSetting=()=>({clips:[],type:"",week:"",remodelList:!1,typeNoRemodel:"",star:0,remodelButtons:!1,assure:"5",searchKit:{min:0,max:0}});class ConfirmDialog{constructor(e){this.inserted=window.parent.document.body.appendChild(e);var t,n=this.inserted.querySelector(".doImport");n.addEventListener("click",e=>this.handleDoImportClick()),t=this.inserted.querySelector(".importCancel"),t.addEventListener("click",e=>this.handleCancelClick()),e.addEventListener("click",e=>this.handleClickHandler(e))}handleClickHandler(e){var t,n,s=e.target;s.classList.contains("confirm-fullscreen")&&(t=s.querySelector(".confirm-content"),t&&(n="bounce",t.classList.contains(n)||(t.classList.add(n),window.parent.setTimeout(()=>{t.classList.remove(n)},310))))}handleDoImportClick(){this.doImport()}handleCancelClick(){this.hide()}show(e){this.import_setting=e,window.parent.setTimeout(()=>{var e;(e=this.inserted)===null||e===void 0||e.classList.add("show")},0)}hide(){var e=this.inserted;this.inserted=void 0,e&&(e.classList.remove("show"),window.parent.setTimeout(()=>{e.remove()},510))}doImport(){if(this.import_setting&&window.localStorage){var e=JSON.stringify(this.import_setting);window.localStorage.setting=e,window.parent.showInit(!1),showToast()}this.hide()}}showClipWeapon=(e,t)=>{var n,o,i,s=document.getElementById("confirm-fullscreen-template");if(!s)return;o=s.content.cloneNode(!0),n=document.createElement("div"),n.classList.add("confirm-fullscreen"),n.appendChild(o),Array.isArray(t.clips)&&insertWeaponsContent(n,t.clips,".import"),Array.isArray(e.clips)&&insertWeaponsContent(n,e.clips,".current"),i=new ConfirmDialog(n),i.show(t)},showToast=()=>{var e,t,n,s,i,o=document.getElementById("toast-content-template");if(!o)return;i=o.content.cloneNode(!0),t=document.createElement("div"),t.classList.add("aia_toast"),t.appendChild(i),n=window.parent.document.body,e=n.insertBefore(t,n.firstChild),e&&(s="show",e.classList.add(s),window.parent.setTimeout(()=>{e.classList.remove(s),window.parent.setTimeout(()=>{e.remove()},500)},3e3))}</script></body></html>